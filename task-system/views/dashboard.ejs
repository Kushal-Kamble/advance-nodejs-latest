<!-- views/dashboard.ejs - User dashboard template -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - ToDo AI</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome - Icons ke liye -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Toastify CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/admin.css">
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm px-4 py-2">
    <div class="container">
      <!-- Logo aur Brand Name -->
      <a class="navbar-brand d-flex align-items-center" href="#">
        <img src="/images/mitsde-logo.svg" alt="Logo" class="dashboard-logo me-2">
        <span class="fs-5 fw-semibold">ToDo AI</span>
      </a>
      
      <!-- User Info aur Logout -->
      <div class="d-flex align-items-center">
        <span class="me-3 text-dark fw-semibold">
          <i class="fas fa-user-circle me-1"></i> <%= user.name %>
        </span>
        <a href="/logout" class="btn btn-outline-danger btn-sm">
          <i class="fas fa-sign-out-alt me-1"></i> Logout
        </a>
      </div>
    </div>
  </nav>

  <!-- Stats Cards Section -->
  <div class="container mt-4">
    <div class="row mb-4" id="statsCards">
      <!-- Total Tasks Card -->
      <div class="col-md-4 mb-3">
        <div class="stats-card">
          <div class="d-flex align-items-center justify-content-between">
            <div>
              <div class="stats-number text-primary" id="totalTasks">0</div>
              <div class="stats-label">Total Tasks</div>
            </div>
            <div class="stats-icon icon-total">
              <i class="fas fa-tasks"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Pending Tasks Card -->
      <div class="col-md-4 mb-3">
        <div class="stats-card">
          <div class="d-flex align-items-center justify-content-between">
            <div>
              <div class="stats-number text-warning" id="pendingTasks">0</div>
              <div class="stats-label">Pending</div>
            </div>
            <div class="stats-icon icon-pending">
              <i class="fas fa-clock"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Completed Tasks Card -->
      <div class="col-md-4 mb-3">
        <div class="stats-card">
          <div class="d-flex align-items-center justify-content-between">
            <div>
              <div class="stats-number text-success" id="completedTasks">0</div>
              <div class="stats-label">Completed</div>
            </div>
            <div class="stats-icon icon-completed">
              <i class="fas fa-check-circle"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tasks List Section -->
  <div class="container pb-5">
    <div class="dashboard-card">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-tasks me-2"></i>Your Tasks</h4>
        <button class="btn btn-brand" data-bs-toggle="modal" data-bs-target="#taskModal">+ Add Task</button>
      </div>
      <!-- Tasks dynamically load honge yahan -->
      <div id="taskList" class="row"></div>
    </div>
  </div>

  <!-- Add/Edit Task Modal -->
  <div class="modal fade" id="taskModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="taskForm">
          <div class="modal-header">
            <h5 class="modal-title">Task</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <!-- Hidden fields -->
            <input type="hidden" name="task_id" id="task_id">
            <input type="hidden" name="user_id" value="<%= user._id %>">

            <!-- Title field -->
            <div class="mb-2">
              <label>Title</label>
              <input name="title" class="form-control" required>
            </div>
            
            <!-- Description field -->
            <div class="mb-2">
              <label>Description</label>
              <textarea name="description" class="form-control"></textarea>
            </div>
            
            <!-- Start Date field -->
            <div class="mb-2">
              <label>Start Date</label>
              <input type="date" name="start_date" class="form-control" required>
            </div>
            
            <!-- Deadline field -->
            <div class="mb-2">
              <label>Deadline</label>
              <input type="date" name="deadline" class="form-control" required>
            </div>
            
            <!-- Priority field -->
            <div class="mb-2">
              <label>Priority</label>
              <select name="priority" class="form-control form-select">
                <option>Low</option>
                <option selected>Medium</option>
                <option>High</option>
              </select>
            </div>
          </div>
          
          <div class="modal-footer">
            <button class="btn btn-success" type="submit" id="saveBtn">
              <span class="spinner-border spinner-border-sm d-none" role="status" id="saveLoader"></span>
              <span id="saveBtnText">Save Task</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Voice Button - Future feature -->
  <button class="btn voice-btn" id="voiceBtn">
    <i class="fas fa-microphone"></i> Ask Task Status
  </button>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="/js/script.js"></script>

  <!-- Welcome Toast on Login -->
  <script>
    // URL se login parameter check karte hain
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('login') === '1') {
      const userName = urlParams.get('user') || '<%= user.name %>';
      Toastify({
        text: `ðŸŽ‰ Welcome ${decodeURIComponent(userName)}!`,
        duration: 4000,
        gravity: "top",
        position: "center",
        backgroundColor: "#28a745",
      }).showToast();
    }
  </script>

</body>
</html>

<!-- ============================================ -->